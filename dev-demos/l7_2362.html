<!--********************************************************************
* Copyright© 2000 - 2023 SuperMap Software Co.Ltd. All rights reserved.
*********************************************************************-->
<!--********************************************************************
* 该示例需要引入 
* G6 (https://github.com/antvis/G6)
*********************************************************************-->
<!DOCTYPE html>
<html>
  <link>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>2362</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100vh;
        overflow: hidden;
      }
      #map {
        width: 100%;
        height: 100%;
      }
      #buttons {
        position: fixed;
        top:10px;
        padding:10px;
        width: 100%;
        display: flex;
        flex-flow: wrap
      }
      #buttons button {
        display: block;
        width: 120px;
        margin: 10px;
      }
    </style>
    <link rel="stylesheet" type="text/css" href="./js/iclient-mapboxgl.css"></link>
    <script type="text/javascript" src="./js/mapbox-gl-enhance.js"></script>
    <script type="text/javascript" src="../mapboxgl-l7-render/dist/index.js"></script> <!-- l7-mapboxgl -->
    <script type="text/javascript" src="./js/iclient-mapboxgl-es6.js"></script>
  </head>

  <body>
    <div id="map"></div>
    <div id="buttons"></div>
    <script type="text/javascript">
      var host = window.isLocal ? window.server : 'https://iserver.supermap.io';
      var attribution =
        "<a href='https://www.mapbox.com/about/maps/' target='_blank'>© Mapbox </a>" +
        " with <span>© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a> | </span>" +
        " Map Data <span>© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> ";

      var tileURL = host + '/iserver/services/map-china400/rest/maps/ChinaDark/zxyTileImage.png?z={z}&x={x}&y={y}';
      // var map = new mapboxgl.Map({
      //   container: 'map',
      //   style: {
      //     version: 8,
      //     sources: {
      //       'raster-tiles': {
      //         attribution: attribution,
      //         type: 'raster',
      //         tiles: [tileURL],
      //         tileSize: 256
      //       }
      //     },
      //     layers: [
      //       {
      //         id: 'simple-tiles',
      //         type: 'raster',
      //         source: 'raster-tiles',
      //         minzoom: 0,
      //         maxzoom: 22
      //       }
      //     ]
      //   },
      //   pitch: 35.210526315789465,
      //   center: [104.288144, 31.239692],
      //   zoom: 4.4,
      //   antialias: true
      // });
      mapboxgl.supermap
        .initMap(host + '/iserver/services/map-mvt-landuse/rest/maps/landuse', {
          type: 'vector-tile',
          mapOptions: {
            zoom: 13
          }
        })
        .then(function (result) {
          var map = result.map;
          window.map = map;
          var data = [
            {
              w: 23.826245,
              t: 24.6,
              s: '海南',
              l: 11,
              m: '东方',
              j: 108.9131417,
              h: 59838,
              v:2,
              mag:8.4,
              value:1,
              name:'01',
              "capacity": 67200,
              "name": "金元坊",
              "icon": "icon1"
            },
            {
              w: 23.85,
              t: 24,
              s: '海',
              l: 12,
              m: '东',
              j: 108.85,
              h: 59838,
              v:2,
              mag:8.4,
              value:2,
              name:'02',
              "capacity": 6720,
              "name": "金元坊",
              "icon": "icon1"
            }
          ];
          var features = {
            type: 'FeatureCollection',
            features: [
              {
                type: 'Feature',
                properties: {length: 10, level:43, "value": -4},
                geometry: {
                  type: 'LineString',
                  coordinates: [
                    [108.9131417, 23.826245],
                    [108.85, 23.85]
                  ]
                }
              }
            ]
          };
          const source = {
            type: 'geojson',
            data: features
          };
          const source2 = {
            type: 'geojson',
            data: {
              type: 'FeatureCollection',
              features: [
                {
                  type: 'Feature',
                  properties: { "name": "Alabama", 'h20': 11},
                  geometry: {
                    type: 'MultiPolygon',
                    coordinates: [[
                      [
                        [108.85, 23.85],
                        [108.9131417, 23.826245],
                        [108.85, 23.9],
                        [108.85, 23.85]
                        // [30, 23],
                        // [109, 23],
                        // [109, 24],
                        // [30, 24],
                      ]
                    ]]
                  }
                }
              ]
            }
          };
          
          map.on('load', () => {
            console.log('load');
            window.map = map;
            var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
            var l7Layer = layer.getL7Layer();
            data.forEach((item) => {
              const { j: lng, w: lat } = item;
              const coor = transformToMultiCoor(lng, lat, map);
              // item.j = coor[0];
              // item.w = coor[1];
              new mapboxgl.Marker().setLngLat([lng, lat]).addTo(map);
              console.log(coor, [lng, lat]);
            });

            function transformToMultiCoor(lng, lat, map) {
              const coor = map.getCRS().fromWGS84([lng, lat]);
              const extent = map.getCRS().getExtent();
              const width = extent[2] - extent[0];
              const height = extent[3] - extent[1];
              const xScale = ((coor[0] - extent[0]) / width) * 512 + 0;
              const yScale = ((extent[3] - coor[1]) / height) * 512 - 128;
              return [xScale, yScale];
            }
            l7Layer
              .source(data, {
                parser: {
                  type: 'json',
                  x: 'j',
                  y: 'w'
                }
              })
              .shape('circle')
              .size(10)
              .color('red');

            var polygonlayer = new mapboxgl.supermap.L7Layer({ type: 'PolygonLayer' });
            var l7Layer3 = polygonlayer.getL7Layer();
            l7Layer3.source(source2.data).color('red').shape('fill');
            createButtons(data, source, source2)
            // creatIconPoint(data, map)
            // creaWallLine(source.data, map)
            // creatTextPolygon(source2.data, map)
  
            // create3DColumnLayer(data, map)
            // createAnimatePoint(data, map)
            // createShpePoint(data, map)
            // creatRadarPoint(data, map)
            // creatTextPoint(data, map)

            // creatImagePoint(data, map)
            // creatPathLine(data, map)
            // crea3dArcLine(data, map)
            // creahighLine(source.data, map)
        
            // crea3DExtrude(source2.data, map)

            // createHeat(data, map)
            // createheatmap3D(data, map)
            // creategrid(data, map)
            // creategrid3D(data, map)
            // createMvtLayer(map)

            map.addLayer(layer);
            // map.addLayer(polygonlayer);

            map.getL7Scene().then(scene=>{
              scene.on('click', (ev) => {
                console.log(ev)
              });
              // scene.fitBounds([
              //   [112, 32],
              //   [114, 35],
              // ]);
            })
            l7Layer.on('click', (e) => {
              console.log('layer: ',e)
            });
            
          });
         
      });
      function createButtons(data, source, source2) {
        const btns = {
            creatIconPoint:()=>creatIconPoint(data, map),
            creaWallLine:()=>creaWallLine(source.data, map),
            creatTextPolygon:()=>creatTextPolygon(source2.data, map),
            create3DColumnLayer:()=>create3DColumnLayer(data, map),
            createAnimatePoint:()=>createAnimatePoint(data, map),
            createShpePoint:()=>createShpePoint(data, map),
            creatRadarPoint:()=>creatRadarPoint(data, map),
            creatTextPoint:()=>creatTextPoint(data, map),
            creatImagePoint:()=>creatImagePoint(data, map),
            creatPathLine:()=>creatPathLine(data, map),
            crea3dArcLine:()=>crea3dArcLine(data, map),
            creahighLine:()=>creahighLine(source.data, map),
            crea3DExtrude:()=>crea3DExtrude(source2.data, map),
            createHeat:()=>createHeat(data, map),
            createheatmap3D:()=>createheatmap3D(data, map),
            creategrid:()=>creategrid(data, map),
            creategrid3D:()=>creategrid3D(data, map),
            createMvtLayer:()=>createMvtLayer(map)
          }
        

          const parentDom = document.querySelector('#buttons')
          Object.keys(btns).map(key=>{
            const btn = document.createElement('button');
            btn.id = key;
            btn.onclick =  btns[key]
            btn.innerHTML = key;
            parentDom.appendChild(btn)
          })
         
        }

      function create3DColumnLayer(data, map) {
          var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
          var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
            parser: {
              type: 'json',
              x: 'j',
              y: 'w'
            }
          }).shape('name', [
            'cylinder',
            'triangleColumn',
            'hexagonColumn',
            'squareColumn'
          ])
          .size('h', h => {
            return [ 6, 6, h / 500 ];
          })
          .color('name', [ '#739DFF', '#61FCBF', '#FFDE74', '#FF896F' ]);
          map.addLayer(layer);
      }
   
     function createShpePoint(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .shape('name', [
          'circle',
          'triangle',
          'square',
          'pentagon',
          'hexagon',
          'octogon',
          'hexagram',
          'rhombus',
          'vesica'
        ])
        .size('l', [ 10, 25 ])
        .active(true)
        .color('name', [ '#5B8FF9', '#5CCEA1', '#5D7092', '#F6BD16', '#E86452' ])
        .style({
          opacity: 0.8,
          strokeWidth: 2
        });
        map.addLayer(layer);
     }
   
     function createAnimatePoint(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .shape('circle')
        .active(true)
        .animate(true)
        .size(40)
        .color('#ffa842')
        .style({
          // offsets: [ 40, 40 ]
        });
        map.addLayer(layer);
     }

     function creatRadarPoint(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .shape('radar')
        .size(100)
        .color('#d00')
        .style({
          speed: 5
        })
        .animate(true);
        map.addLayer(layer);
     }
   
     function creatTextPoint(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .shape('name', 'text')
        .size(50)
        .color('#084081')
        .style({
          textAnchor: 'center', // 文本相对锚点的位置 center|left|right|top|bottom|top-left
          textOffset: [ 0, 0 ], // 文本相对锚点的偏移量 [水平, 垂直]
          spacing: 2, // 字符间距
          padding: [ 1, 1 ], // 文本包围盒 padding [水平，垂直]，影响碰撞检测结果，避免相邻文本靠的太近
          stroke: '#ffffff', // 描边颜色
          strokeWidth: 2, // 描边宽度
          strokeOpacity: 1.0,
          // rotation: 60, // 常量旋转
          rotation:{ // 字段映射旋转
            field: 't',
            value:[30,270]
          }
        });
        map.addLayer(layer);
     }
   
     function creatTextPolygon(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PolygonLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data)
        .color('blue')
        .shape('name', 'text')
        .size(18)
        .style({
          textAnchor: 'center', // 文本相对锚点的位置 center|left|right|top|bottom|top-left
          textOffset: [ 0, 0 ], // 文本相对锚点的偏移量 [水平, 垂直]
          spacing: 2, // 字符间距
          padding: [ 1, 1 ], // 文本包围盒 padding [水平，垂直]，影响碰撞检测结果，避免相邻文本靠的太近
          stroke: '#ffffff', // 描边颜色
          strokeWidth: 0.3, // 描边宽度
          strokeOpacity: 1.0
        });
        map.addLayer(layer);
     }

     function creatIconPoint(data, map) {
      map.getL7Scene().then(scene=>{
        const fontFamily = 'iconfont';
        const fontPath = '//at.alicdn.com/t/font_2534097_fcae9o2mxbv.woff2?t=1622200439140';
        scene.addFontFace(fontFamily, fontPath);
        scene.addIconFont('icon1', '&#xe6d4;');
        scene.once('fontloaded', () => {
          var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
          var l7Layer = layer.getL7Layer();
            l7Layer.source(data, {
            parser: {
              type: 'json',
              x: 'j',
              y: 'w'
            }
          })
          .shape('icon', 'text')
          .size(20)
          .color('blue')
          .style({
            textAnchor: 'center', // 文本相对锚点的位置 center|left|right|top|bottom|top-left
            // padding: [ 0, 0 ], // 文本包围盒 padding [水平，垂直]，影响碰撞检测结果，避免相邻文本靠的太近
            stroke: '#ffffff', // 描边颜色
            fontFamily,
            iconfont: true,
            textAllowOverlap: true
          });
          map.addLayer(layer);
        })
      })
     }
   
     function creatIconTempPoint(data, map) {
      map.getL7Scene().then(scene=>{
        const fontFamily = 'iconfont';
        const fontPath =
          '//at.alicdn.com/t/font_2534097_x6rsov3i1g.woff2?t=1622107341225';
        scene.addIconFont('icon1', '&#xe69e;');
        scene.addFontFace(fontFamily, fontPath);

        const colors = [
          '#87CEFA',
          '#00BFFF',

          '#7FFFAA',
          '#00FF7F',
          '#32CD32',

          '#F0E68C',
          '#FFD700',

          '#FF7F50',
          '#FF6347',
          '#FF0000'
        ];

        scene.once('fontloaded', () => {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .shape('icon', 'text')
        .size(25)
        .style({
          textAnchor: 'center', // 文本相对锚点的位置 center|left|right|top|bottom|top-left
          textOffset: [ -25, 15 ],
          padding: [ 2, 2 ],
          fontFamily,
          iconfont: true,
          textAllowOverlap: true
        });
        map.addLayer(layer);
      })
      })
     }
   
     function creatImagePoint(data, map) {
      map.getL7Scene().then(scene=>{
        scene.addImage(
          '00',
          'https://gw.alipayobjects.com/zos/basement_prod/604b5e7f-309e-40db-b95b-4fac746c5153.svg'
        );
        scene.addImage(
          '01',
          'https://gw.alipayobjects.com/zos/basement_prod/30580bc9-506f-4438-8c1a-744e082054ec.svg'
        );
        scene.addImage(
          '02',
          'https://gw.alipayobjects.com/zos/basement_prod/7aa1f460-9f9f-499f-afdf-13424aa26bbf.svg'
        );

        var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer.source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .shape('name', [ '00', '01', '02' ])
        .size(50);
        map.addLayer(layer);
      })
     }

     function creatPathLine(data, map) {
     
      var data1 = [
        {
          "level": 2,
          "number": "902",
          "path": [
            [
            108.9131417, 23.826245,
              420
            ],
            [
            108.85, 23.85,
              420
            ]
          ]
        }
      ]
        var layer = new mapboxgl.supermap.L7Layer({ type: 'LineLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data1, {
          parser: {
            type: 'json',
            coordinates: 'path'
          }
        })
          .size('level', level => {
            return [ 0.8, level * 0.1 ];
          })
        .shape('line')
        .active(true)
        .color('number', [
          '#0A3663',
          '#1558AC',
          '#3771D9',
          '#4D89E5',
          '#64A5D3',
          '#72BED6',
          '#83CED6',
          '#A6E1E0',
          '#B8EFE2',
          '#D7F9F0'
        ]);
        map.addLayer(layer);
     }
   
     function crea3dArcLine(data, map) {
      // [108.9131417, 23.826245],
      //               [108.85, 23.85]
      var data1 = [
            {
          "tripduration": 452,
          "starttime": "2017-12-01 00:00:59",
          "stoptime": "2017-12-01 00:08:32",
          "start station id": 3183,
          "start station name": "Exchange Place",
          "start station latitude": 23.826245,
          "start station longitude": 108.9131417,
          "end station id": 3199,
          "end station name": "Newport Pkwy",
          "end station latitude": 23.85,
          "end station longitude": 108.85,
          "bikeid": 29607,
          "usertype": "Subscriber",
          "birth year": 1988,
          "gender": 1
        },
      ]
        var layer = new mapboxgl.supermap.L7Layer({ type: 'LineLayer' ,options:{ blend: 'normal'}}, );
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data1, {
          parser: {
            type: 'json',
            x: 'start station longitude',
            y: 'start station latitude',
            x1: 'end station longitude',
            y1: 'end station latitude'
          }
        })
        .size(2)
        .shape('arc3d')
        .color('red')
        // .animate({
        //   interval: 0.5,
        //   trailLength: 0.5,
        //   duration: 5
        // })
        .style({
          opacity: 1
        });
        map.addLayer(layer);
     }
   
     function creahighLine(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'LineLayer' ,options:{ blend: 'normal'}}, );
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data)
        .scale('value', {
          type: 'quantile'
        })
        .size('value', [ 0.5, 1, 1.5, 2 ])
        .shape('line')
        .color(
          'value',
          [
            '#0A3663',
            '#1558AC',
            '#3771D9',
            '#4D89E5',
            '#64A5D3',
            '#72BED6',
            '#83CED6',
            '#A6E1E0',
            '#B8EFE2',
            '#D7F9F0'
          ].reverse()
        );
        map.addLayer(layer);
     }

     function creaWallLine(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'LineLayer' ,options:{ blend: 'normal'}}, );
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data)
          .size(40)
        .shape('wall')
        .style({
          heightfixed: true,
          opacity: 1,
          sourceColor: '#0DCCFF',
          targetColor: 'rbga(255,255,255, 0)'
        });
        map.addLayer(layer);
     }
   
     function crea3DExtrude(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'PolygonLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data)
          .shape('extrude')
          .size(5000)
          .color('red').style({
            // heightfixed:true
          });
        map.addLayer(layer);
     }

     function createHeat(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'HeatmapLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data,{parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }})
          .shape('heatmap')
        .size('mag', [ 0, 1.0 ]) // weight映射通道
        .style({
          intensity: 2,
          radius: 20,
          rampColors: {
            colors: [
              '#FF4818',
              '#F7B74A',
              '#FFF598',
              '#91EABC',
              '#2EA9A1',
              '#206C7C'
            ].reverse(),
            positions: [ 0, 0.2, 0.4, 0.6, 0.8, 1.0 ]
          }
        });
        map.addLayer(layer);
     }

     function createheatmap3D(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'HeatmapLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data,{
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          }
        })
        .size('capacity', [ 0, 1 ])
        .shape('heatmap3D')
      // weight映射通道
        .style({
          intensity: 5,
          radius: 10,
          rampColors: {
            colors: [
              '#2E8AE6',
              '#69D1AB',
              '#DAF291',
              '#FFD591',
              '#FF7A45',
              '#CF1D49'
            ],
            positions: [ 0, 0.2, 0.4, 0.6, 0.8, 1.0 ]
          }
        });
        map.addLayer(layer);
     }
   
     function creatTextPoint(data, map) {
            console.log('creatTextPoint')
            var layer = new mapboxgl.supermap.L7Layer({ type: 'PointLayer' });
            var l7Layer = layer.getL7Layer();
              l7Layer
              .source(data, {
                parser: {
                  type: 'json',
                  x: 'j',
                  y: 'w'
                }
              })
            .shape('name', 'text')
            .size(50)
            .color('red')
            .style({
              textAnchor: 'center', // 文本相对锚点的位置 center|left|right|top|bottom|top-left
              textOffset: [ 0, 0 ], // 文本相对锚点的偏移量 [水平, 垂直]
              spacing: 2, // 字符间距
              padding: [ 1, 1 ], // 文本包围盒 padding [水平，垂直]，影响碰撞检测结果，避免相邻文本靠的太近
              stroke: '#ffffff', // 描边颜色
              strokeWidth: 2, // 描边宽度
              strokeOpacity: 1.0,
              rotation: 0, // 常量旋转
              // rotation:{ // 字段映射旋转
              //   field: 't',
              //   value:[30,270]
              // }
            });
            map.addLayer(layer);
          }
   
     function creategrid(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'HeatmapLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          },
          transforms: [
            {
              type: 'grid',
              size: 200,
              field: 'v',
              method: 'sum'
            }
          ]
        })
        .shape('square')
        .style({
          coverage: 1,
          angle: 0
        })
        .color('red');
        map.addLayer(layer);
     }
  
     function creategrid3D(data, map) {
        var layer = new mapboxgl.supermap.L7Layer({ type: 'HeatmapLayer' });
        var l7Layer = layer.getL7Layer();
          l7Layer
          .source(data, {
          parser: {
            type: 'json',
            x: 'j',
            y: 'w'
          },
          transforms: [
            {
              type: 'hexagon',
              size: 250,
              field: 'v',
              method: 'sum'
            }
          ]
        })
        .size('sum', [ 0, 600 ])
        .shape('hexagonColumn')
        .style({
          coverage: 0.8,
          angle: 0,
        })
        .color('sum', [
          '#094D4A',
          '#146968',
          '#1D7F7E',
          '#289899',
          '#34B6B7',
          '#4AC5AF',
          '#5FD3A6',
          '#7BE39E',
          '#A1EDB8',
          '#C3F9CC',
          '#DEFAC0',
          '#ECFFB1'
        ]);
        map.addLayer(layer);
     }
  
     function createMvtLayer(map) {
        const url = 'https://mvt.amap.com/district/CHN2/{z}/{x}/{y}/4096?key=309f07ac6bc48160e80b480ae511e1e9&version=';
          const source = new L7.Source(url, {
            parser: {
              type: 'mvt',
              tileSize: 256,
              warp: false
            }
          });
          const colors = {};
          const GDPSpeed = {
            520000: 10, //贵州
            540000: 10, //西藏
            530000: 8.5, //云南
            500000: 8.5, //重庆
            360000: 8.5, //江西
            340000: 8.0, //安徽
            510000: 7.5, //四川
            350000: 8.5, //福建
            430000: 8.0, //湖南
            420000: 7.5, //湖北
            410000: 7.5, //河南
            330000: 7.0, //浙江
            640000: 7.5, //宁夏
            650000: 7.0, //新疆
            440000: 7.0, //广东
            370000: 7.0, //山东
            450000: 7.3, //广西
            630000: 7.0, //青海
            320000: 7.0, //江苏
            140000: 6.5, //山西
            460000: 7, // 海南
            310000: 6.5, //上海
            110000: 6.5, // 北京
            130000: 6.5, // 河北
            230000: 6, // 黑龙江
            220000: 6, // 吉林
            210000: 6.5, //辽宁
            150000: 6.5, //内蒙古
            120000: 5, // 天津
            620000: 6, // 甘肃
            610000: 8.5, // 甘肃
            710000: 6.64, //台湾
            810000: 6.0, //香港
            820000: 6.7 //澳门
          };
          const getColorByDGP = function (adcode) {
            if (!colors[adcode]) {
              const gdp = GDPSpeed[adcode];
              if (!gdp) {
                colors[adcode] = 'rgb(227,227,227)';
              } else {
                const rg = 255 - Math.floor(((gdp - 5) / 5) * 255);
                colors[adcode] = 'rgb(' + rg + ',' + rg + ',255)';
              }
            }
            return colors[adcode];
          };
          var fill = new mapboxgl.supermap.L7Layer({ type: 'PolygonLayer', options: { sourceLayer: 'CHN_Cities' } });
          fill.getL7Layer().source(source).shape('fill').color('adcode_pro', getColorByDGP);

          var line = new mapboxgl.supermap.L7Layer({ type: 'LineLayer', options: { sourceLayer: 'CHN_Cities_L' } });
          line.getL7Layer().source(source).shape('line').color('#FFA500');

          var line2 = new mapboxgl.supermap.L7Layer({ type: 'LineLayer', options: { sourceLayer: 'CHN_L' } });
          line2.getL7Layer().source(source).shape('line').size(0.6).color('#053061');

          var line3 = new mapboxgl.supermap.L7Layer({
            type: 'PointLayer',
            options: { sourceLayer: 'CHN_Cities', blend: 'normal' }
          });
          line3.getL7Layer().source(source).shape('id', 'text').size(12).color('#000');

          map.addLayer(fill);
          map.addLayer(line);
          map.addLayer(line2);
          map.addLayer(line3);
      }
    
    </script>
  </body>
</html>
